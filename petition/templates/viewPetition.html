{% extends 'layouts/base.html' %}

{% load static %}

{% block content %}

<title>Solicitudes</title>

<link rel="stylesheet" href="{% static 'styles/viewPetition.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

<!-- DataTable -->
<link
rel="stylesheet"
type="text/css"
href="https://cdn.datatables.net/1.13.1/css/dataTables.bootstrap5.min.css"
/>
<link
rel="stylesheet"
type="text/css"
href="https://cdn.datatables.net/buttons/2.3.3/css/buttons.bootstrap5.min.css"
/>
<!-- Bootstrap-->
<link
rel="stylesheet"
href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
/>
<!-- Font Awesome -->
<link
rel="stylesheet"
href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
crossorigin="anonymous"
referrerpolicy="no-referrer"
/>

{% csrf_token %}
<h1>Solicitudes</h1>

<div class="container">
    <div class="row">
        <div class="tableResponsive">
            <table class="table table-bordered table-striped" id="dataTablePetition">
    
                    
                <thead class="thead-dark">
                    <th>Id Solicitud</th>
                    <th>Tipo </th>
                    <th>Fecha inicio</th>
                    <th>Fecha Fin</th>
                    <th>Estado</th>
                    <th>Cenco</th>
                    <th>Nombre</th>
                    <th>CC/TI</th>    
                    <th>Correo Electronico</th>
                    <th>Telefono</th>
                    <th>Fecha Solicitud</th>
                    <th>Id Gestor</th>
                    <th>Opciones</th>
                </thead>
                <body>
                    {% for petition in petitions %}
                    <tr>
                        <td><a href="{% url 'showPetition' petition.id %}"><p>{{ petition.id }}</p> </a></td>
                        <td>{{ petition.getPetitionType }}</td>
                        <td>{{ petition.startDate }}</td>
                        <td>{{ petition.endDate }}</td>
                        <td>{{ petition.getState }}</td>
                        <td>{{ petition.cenco }}</td>
                        <td>{{ petition.fullName }}</td>
                        <td>{{ petition.identityDocument }}</td>
                        <td>{{ petition.email }}</td>
                        <td>{{ petition.phoneNumber }}</td>
                        <td>{{ petition.petitionDate }}</td>
                        <td>{{ petition.user_id }}</td>   
                        <td>
                            <div class="buttons">
                                <div class="divButton">
                                    {% csrf_token %}
                                    {% if petition.getState == "Pendiente" or petition.getState == "En Proceso" %}
                                    <a href="{% url 'rejectPetition' petition.id %}" ><button type="button" class="edit-icon" onclick="rejectPetition( {{petition.id}})">
                                        <i class="fas fa-ban"></i>
                                    </button>
                                    </a>
                                    {% endif %}
                                </div>
                                <div class="divButton">
                                    <form id="deleteForm{{ petition.id }}" action="{% url "deletePetition" petition.id%}" method="POST">
                                        {% csrf_token %}
                                        {% if petition.getState == "Pendiente" or petition.getState == "En Proceso" %}
                                            <button type="button" class="delete-icon" data-petition-id="{{ petition.id }}" onclick="confirmDelete({{ petition.id }})"><i class="fas fa-trash-alt"></i></button>
                                        {% endif %}
                                    </form>
                                </div>  
                                
                                          
                            </div> 
                        </td>    
                    </tr>

                    {% endfor %}
                   
             
                </body>
                
            </table>
        </div>
    </div>
</div>

 <!-- JQuery -->
 <script
 src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"
 integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
 crossorigin="anonymous"
 referrerpolicy="no-referrer"
></script>
<!-- DataTable -->
<script
 type="text/javascript"
 src="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.5.0/jszip.min.js"
></script>
<script
 type="text/javascript"
 src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"
></script>
<script
 type="text/javascript"
 src="https://cdn.datatables.net/1.13.1/js/dataTables.bootstrap5.min.js"
></script>
<script
 type="text/javascript"
 src="https://cdn.datatables.net/buttons/2.3.3/js/dataTables.buttons.min.js"
></script>
<script
 type="text/javascript"
 src="https://cdn.datatables.net/buttons/2.3.3/js/buttons.bootstrap5.min.js"
></script>
<script
 type="text/javascript"
 src="https://cdn.datatables.net/buttons/2.3.3/js/buttons.html5.min.js"
></script>
<script
 type="text/javascript"
 src="https://cdn.datatables.net/buttons/2.3.3/js/buttons.print.min.js"
></script>









<!-- Bootstrap-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<!-- JsScripts-->
<script src="{% static 'scripts/viewPetition.js' %}"></script>
<script src="{% static 'scripts/deleteElement.js' %}"></script>
<script src="{% static 'scripts/viewObservation.js' %}"></script>








{% endblock %}