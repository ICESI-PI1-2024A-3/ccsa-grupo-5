{% extends 'layouts/base.html' %}

{% load static %}

{% block content %}

<title>Solicitudes</title>

<link rel="stylesheet" href="{% static 'styles/viewPetition.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css">

<!-- DataTable.js -->
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.1/css/dataTables.bootstrap5.min.css" />

<!-- Bootstrap -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous" />
<!-- DataTable.js -->

{% csrf_token %}
<h1>Solicitudes</h1>

<div class="container">
    <div class="row">
        <div class="tableResponsive">
            <table id="dataTablePetition">
                <thead>
                    <th>Id Solicitud</th>
                    <th>Fecha inicio</th>
                    <th>Fecha Fin</th>
                    <th>Estado</th>
                    <th>Cenco</th>
                    <th>Nombre Completo</th>
                    <th>CC/TI</th>
                    <th>Correo Electronico</th>
                    <th>Telefono</th>
                    <th>Fecha Solicitud</th>
                    <th>Id Gestor</th>
                    <th>Opciones</th>
                </thead>
                <body>
                    {% for petition in petitions %}
                    <tr>
                        <td>{{ petition.id }}</td>
                        <td>{{ petition.startDate }}</td>
                        <td>{{ petition.endDate }}</td>
                        <td>{{ petition.state }}</td>
                        <td>{{ petition.cenco }}</td>
                        <td>{{ petition.fullName }}</td>
                        <td>{{ petition.identityDocument }}</td>
                        <td>{{ petition.email }}</td>
                        <td>{{ petition.phoneNumber }}</td>
                        <td>{{ petition.petitionDate }}</td>
                        <td>{{ petition.user_id }}</td>
                        <td>
                            {% csrf_token %}
                            <div class="buttons" >
                                <div class="divButton">
                                    <a href="{% url 'rejectPetition' petition.id %}" ><button type="button" class="edit-icon" onclick="rejectPetition( {{petition.id}})">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>

                                <div class="divButton">
                                <form id="deleteForm{{ petition.id }}" action="{% url "deletePetition" petition.id%}" method="POST">
                                <button type="button" class="delete-icon" data-petition-id="{{ petition.id }}" onclick="confirmDelete({{ petition.id }})">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                                </div>
                        </td>
                            
                    </tr>
                    {% endfor %}
                </body>
            </table>
        </div>
    </div>
</div>

 <!-- Bootstrap -->
 <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
 <!-- jQuery -->

<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- DataTable.js -->
<script src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.1/js/dataTables.bootstrap5.min.js"></script>

<script src="{% static 'scripts/deleteElement.js' %}"></script>
<script src="{% static 'scripts/viewObservation.js' %}"></script>
<script src="{% static 'scripts/viewPetition.js' %}"></script>

{% comment %}
<div>
    {% for petition in petitions %}
    <div class="card">
        <a href="{% url 'showPetition' petition.id %}">
            <h4>{{ petition.petitionDate }} - {{ petition.fullName }}</h4>
        </a>
        <p>Tipo de contrato: {{ petition.getPetitionType }}</p>
        <p><b>Estado: {{ petition.state }}</b></p>
        <p>Cedula: {{ petition.identityDocument }}</p>
        <p>Fecha inicio: {{ petition.startDate }}</p>
        <p>Fecha fin: {{ petition.endDate }}</p>
        <p>Gestor encargado: <b>{{ petition.getUser }}</b></p>
        <form id="deleteForm{{ petition.id }}" action="{% url "deletePetition" petition.id%}" method="POST">
            {% csrf_token %}
            <button type="button" class="delete-icon" data-petition-id="{{ petition.id }}" onclick="confirmDelete({{ petition.id }})">
                <i class="fas fa-trash-alt"></i> Eliminar
            </button> 
        </form>
        
    </div>
    {% endfor %}

</div>
{% endcomment %}
{% endblock %}